<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-list/core-list.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/core-overlay/core-overlay.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">

<polymer-element name="zuks-group-list" attributes="volunteerGroups">
  <template>
    <style>
    :host {
      display: block;
      height: 100%;
      overflow: scroll;
    }

    core-list {
      height: 100%;
    }

    .item {
      height: 70px;
      padding-right: 16px;
      padding-left: 16px;
      padding-top: 4px;
      padding-bottom: 4px;
      cursor: pointer;
    }

    .item.selected .container {
      background: #eee;
    }

    .container, paper-shadow {
      height: 100%;
    }

    .content {
      padding-left: 10px;
    }

    </style>

    <core-list data="{{volunteerGroups.values}}" selectionenabled on-core-activate="{{groupSelected}}" id="list">
      <template>
        <div class="item {{ {selected: selected} | tokenList }}">
          <paper-shadow>
            <div horizontal layout center class="container">
              <div class="content">{{model.name}}</div>
            </div>
            <paper-ripple fit></paper-ripple>
          </paper-shadow>
        </div>
      </template>
    </core-list>

    <paper-action-dialog heading="Gruppe {{actionName}}" id="addGroup" backdrop on-core-overlay-close-completed="{{groupDialogClosed}}">
        <paper-input label="Name" autofocus floatingLabel value="{{group.name}}"></paper-input>

        <paper-button dismissive>Abbrechen</paper-button>
        <paper-button affirmative default on-click="{{saveGroup}}" style="color:#4d9eff">Speichern</paper-button>
    </paper-action-dialog>

  </template>
  <script>
  Polymer({
    groupSelected: function(event) {
      this.group = $.extend(true, {}, event.detail.data);
      this.actionName = "aktualisieren";
      this.$.addGroup.open();
    },
    addGroup: function() {
      this.group = {name: "", members: []};
      this.actionName = "hinzuf√ºgen";
      this.$.addGroup.open();
    },
    saveGroup: function() {
      if (this.group.id) {
        this.fire("update", this.group);
      } else {
        this.fire("create", this.group);
      }
    },
    groupDialogClosed: function() {
      this.$.list.clearSelection();
    }
  });
  </script>
</polymer-element>
